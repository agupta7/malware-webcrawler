#!/usr/bin/python -uB
import weightedknn.weighted_knn as wknn
from assignment2 import loadDataset
import numpy as np
import sys
import pickle
from onlineClassifiers.URLVoid import URLVoid

def treeToList(unigramTree, unigramList = []):
    unigramList = unigramList or []
    if unigramTree is None:
        return []
    for link in (unigramTree['links'] or []):
        unigramList.append(link)
        treeToList(link, unigramList)
    return unigramList

if __name__ == "__main__":
    if len(sys.argv) < 3:
        print >> sys.stderr, "Usage: {0} urllist_file unigrams...".format(sys.argv[0])
        sys.exit()
    urllist = open(sys.argv[1]).read().split('\n')[:-1]
    unigramFiles = sys.argv[2:]
    unigramList = []

    for rootURL in unigramFiles:
        if '.unigram' in rootURL:
            unigramTree = pickle.load(open(rootURL, 'rb'))
            unigramList.extend(treeToList(unigramTree))

    for unigram in unigramList:
        if unigram['url'] in urllist:
            print unigram['url']
           #classification = URLVoid().classify(unigram['url']) 
           #print unigram['url'] + ', ' + str(classification) + ', ' + str(unigram['unigram'])[1:-1]
