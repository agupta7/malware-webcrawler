import requests
import xml.etree.ElementTree as ET

class URLVoid:
    def __init__(self):
        self.apiKey = "bb6c304db60394e339eef97ad07f3f2d862ac3b2"

    def classify(self, url):
        # code here to call WOT service and return 1 for suspicious and -1 for safe
        url = 'http://api.urlvoid.com/api1000/' + self.apiKey + '/host/' + url 
        response = requests.get(url)
        
        xmlTree = ET.fromstring(response.text)

        detectionCount = xmlTree.findall('.//count')[0].text
        detectionCount = int(detectionCount) if not None or not '' else 0

        return detectionCount > 3

